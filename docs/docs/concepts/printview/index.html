<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.122.0">
<link rel="canonical" type="text/html" href="https://butler.ptarmiganlabs.com/docs/concepts/">
<link rel="alternate" type="application/rss&#43;xml" href="https://butler.ptarmiganlabs.com/docs/concepts/index.xml">
<meta name="robots" content="noindex, nofollow">
<script defer data-domain="butler.ptarmiganlabs.com" src="https://plausible.io/js/script.js"></script>

<link rel="canonical" href="https://butler.ptarmiganlabs.com/docs/concepts/" />



<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Concepts | Butler</title>
<meta name="description" content="Deep dive into the various components that make up Butler. 
">
<meta property="og:title" content="Concepts" />
<meta property="og:description" content="Deep dive into the various components that make up Butler. 
" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://butler.ptarmiganlabs.com/docs/concepts/" />

<meta itemprop="name" content="Concepts">
<meta itemprop="description" content="Deep dive into the various components that make up Butler. 
"><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Concepts"/>
<meta name="twitter:description" content="Deep dive into the various components that make up Butler. 
"/>




<link rel="preload" href="/scss/main.min.760be0d42a95747f7072e6cf9b47cc5c5c4d7715dd765fd062712100e6b3d9d8.css" as="style">
<link href="/scss/main.min.760be0d42a95747f7072e6cf9b47cc5c5c4d7715dd765fd062712100e6b3d9d8.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

  </head>
  <body class="td-section">
    <header>
      <nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"></span><span class="navbar-brand__name">Butler</span></a>
  <div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
    <ul class="navbar-nav mt-2 mt-lg-0">
      </ul>
  </div>
  <div class="navbar-nav d-none d-lg-block">
    
  </div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/docs/concepts/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Concepts</h1>
<div class="lead">Deep dive into the various components that make up Butler.</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-a45374e60a00882bb44a7492c8b95e08">Key-value store</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>2: <a href="#pg-3a788bf3311ddc709d4a9021379da16d">Scheduler</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3: <a href="#pg-2eacc0a085abb47e5414dfd9fb8120b3">Failed/aborted reloads</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.1: <a href="#pg-b122b0663c6199cf05ed239edede06e7">Alert emails</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3.2: <a href="#pg-a50a38f6834b0485b50aa321ea429862">Alerts via Slack and Microsoft Teams</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3.3: <a href="#pg-1487bc32760b32de8c233d20e06b2981">Storing script logs of failed reloads to disk</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3.4: <a href="#pg-2572b5d0bb912bb2fe6598f2112aa5c4">InfluxDB</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3.5: <a href="#pg-bb0b42e65c84552525f295e8402fc090">New Relic</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3.6: <a href="#pg-ae3289abc4fde74201ada2090f471d10">MQTT</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3.7: <a href="#pg-da76efdcdc38f4b3df6afb92ec23202c">Signl4</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3.8: <a href="#pg-047e1db6b8a4141a89e5a2106def9fa3">Webhooks</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  

    </ul>
    
  
    
    
	
<li>4: <a href="#pg-69e2de1d5353f0be5eeaaa13f72505af">Successful reloads</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>5: <a href="#pg-058a8f0a0aec0d9c7e790ea7fc82eb79">Starting Sense tasks in style</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>6: <a href="#pg-f6643c486e610f90387a66f5864c5f88">Incident management tools</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>6.1: <a href="#pg-5c7b057bc2c2752268a343fe42ce5775">New Relic</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>6.2: <a href="#pg-62f43ebd86994233e80c685703acd08d">Signl4</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  

    </ul>
    
  
    
    
	
<li>7: <a href="#pg-d53b327fc967acd8173b66baaf9430d6">Qlik Sense licenses</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>8: <a href="#pg-1ac4fd4b7c9bf1db2e94deeef12e64c6">File system access: copy/move/delete files</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>9: <a href="#pg-54cf36a5b3033781aa5a15d5bc3676b6">MQTT integration</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>10: <a href="#pg-ea75db05eef40e825410085639630380">UDP client</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>11: <a href="#pg-cd624950aeaafeeed59dd958b408e6b6">Monitor Windows services</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>12: <a href="#pg-30913de421ba8a1881920f31d3308f5e">Real-time metrics</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-a45374e60a00882bb44a7492c8b95e08">1 - Key-value store</h1>
    <div class="lead">Overview of the key-value database concept and how it is imlpemented in Butler.</div>
	<h2 id="storing-key-value-pairs-in-butler">Storing key-value pairs in Butler</h2>
<p>The key-value (=KV) feature in Butler is a basic variant of the more complex <a href="https://en.wikipedia.org/wiki/Key%E2%80%93value_database">KV databases available</a> out there, with <a href="https://etcd.io/">etcd</a>, <a href="https://ignite.apache.org/">Apache Ignite</a> and <a href="https://memcached.org/">memcached</a> being popular open source options. All the major cloud providers also have their own KV database products.</p>
<p>Butler&rsquo;s KV features are basic, yet very useful in the context of Qlik Sense. The only assumptions are:</p>
<ul>
<li>You have a value you want to store for some time outside of your Sense app.</li>
<li>There is a unique key for each value you want to store.</li>
</ul>
<p>Put differently: Think of Butler&rsquo;s KV store as a way to stash away some values, then get them back later when they are needed again.</p>
<p>Each KV pair is associated with a <em>namespace</em>. Namespaces are simply a way to categorize KV pairs.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Remember</h4>

    Both key and value are strings in Butler&rsquo;s KV store. You must thus make sure to convert your data to strings before creating or updating a KV pair.

</div>

<p>There is also an optional, per KV-pair Time To Live (TTL) feature. If used it will auto-delete the KV pair when a certain time has passed from the KV-pair&rsquo;s last update.</p>
<p>The <a href="/docs/reference/rest-api-1/">API docs</a> shows what methods are available to work with KV pairs.</p>
<h2 id="how-can-a-key-value-store-be-used-in-sense-apps">How can a key-value store be used in Sense apps?</h2>
<p>As mentioned above - A KV store can be useful whenever you need to stash data away for a while and then get it back. I.e. keeping track of the state of something.</p>
<p>For example</p>
<ul>
<li>
<p><strong>Easily pass parameters beteen apps in a reload chain</strong>
Let&rsquo;s assume data is created when appA reloads as part of an hourly reload schedule. That data is needed in appB, which is triggered to reload when appA finishes its reload. But how do you get the data from appA to appB?</p>
<p>Historically you solve this by writing the data to a temporary QVD or CSV file. This still works of course, but if it&rsquo;s only some dimensional value that needs to be passed, a KV store might be a cleaner option.</p>
</li>
<li>
<p><strong>Keep a time limited state</strong>
The TTL feature is useful to keep things tidy. If you know for sure that your KV pair only needs to be stored for a limited time, it&rsquo;s good practice to either delete it when its no longer needed, or set a TTL when the KV pair is first created.</p>
<p>This way you keep the KV namespaces relevant and reasonable in size.</p>
</li>
<li>
<p><strong>Use app IDs as namespace names</strong>
If you need to keep state between successive reloads of a particular app, you can use the app ID as namespace. That way it will be very clear which a specific KV pair belongs to.</p>
</li>
<li>
<p><strong>Keep track of what users should be notified after an app reload is complete</strong>
Let&rsquo;s say you have a button in an app that when clicked kicks of a reload of the app (or some other app).
Let&rsquo;s also assume several users might be interested in triggering a refresh of this dataset.</p>
<p>By pushing each user&rsquo;s username to a KV namespace when they request the data refresh (by clicking that button in the app), it&rsquo;s possible to notify them using Teams, Slack, email etc as the last step of the app&rsquo;s reload script (i.e. when the app
ist just about done refreshing the data).</p>
<p>The effect is a solution where users can request a data refresh and be notified when the new data is available.</p>
</li>
<li>
<p><strong>Keeping state in visualisation extensions</strong>
Extensions are built using Javascript, and they can thus also make use of the KV store.</p>
<p>There might be times when several extension instances in an app need to keep in sync or share some state - a KV store might be useful there.<br>
The KV store could even allow an extension to share state with its siblings in other Sense apps.</p>
</li>
</ul>
<h2 id="persistence-of-key-value-data">Persistence of key-value data</h2>
<p>As of current Butler version (v4.0), KV pairs are not persisted to disk.<br>
Is this good or bad? It depends:</p>
<ul>
<li>Good as it reduces complexity in Butler.</li>
<li>Bad as all KV pairs are lost when Butler is restarted. Now, Butler tends to be very stable, so spontaneous restarts are usually not a problem. But the flushing of all KV data is still something to consider when for example upgrading Butler to new versions.</li>
</ul>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-3a788bf3311ddc709d4a9021379da16d">2 - Scheduler</h1>
    <div class="lead">The how and why of the Butler scheduler.</div>
	<h2 id="what-is-a-scheduler">What is a scheduler?</h2>
<p>In the context of Qlik Sense, a scheduler is a tool that <em>triggers</em> Qlik Sense <em>tasks</em> at some specific time or interval.<br>
Qlik Sense Enterprise has its own, <a href="https://help.qlik.com/en-US/sense-admin/September2020/Subsystems/DeployAdministerQSE/Content/Sense_DeployAdminister/QSEoW/Administer_QSEoW/Managing_QSEoW/schedulers-overview.htm">built-in scheduler</a> that can be accessed via the QMC.</p>
<p>The QMC interface to Sense&rsquo;s standard scheduler lets you create schedules for two kinds of tasks:</p>
<ul>
<li>App reload tasks</li>
<li>User directory sync tasks</li>
</ul>
<h2 id="whats-wrong-with-senses-own-scheduler">What&rsquo;s wrong with Sense&rsquo;s own scheduler?</h2>
<p>The built-in scheduler in Qlik Sense is ok in most aspects, but lack significantly in some.<br>
Specifically, it doesn&rsquo;t allow you to run a task certain hours of the day. At least not without resorting to creating lots of task triggers - which is not an attractive option from a maintenance perspective.</p>
<p>This is a quite common scenario and thus Butler gets its own scheduler to solve the issue.</p>
<h2 id="the-butler-scheduler">The Butler scheduler</h2>
<p>Butler&rsquo;s scheduler is based on <a href="https://en.wikipedia.org/wiki/Cron">cron</a>.<br>
Cron has been the standard scheduler for decades in most Linux systems, it&rsquo;s thus a proven concept.</p>
<p>Features of the Butler scheduler:</p>
<ul>
<li>6 position cron pattern. The leftmost position represents seconds.</li>
<li>5 postition patterns are also supported, the leftmost position then represents minutes.</li>
<li>Hundreds of schedules tested and confirmed working as expected.</li>
<li>A Qlik Sense task ID is associated with each schedule. When the schedule fires, the associated task is started.</li>
<li>Schedules can be added either manually in the YAML schedules file (as defined in the main Butler config file) or using <a href="/docs/reference/rest-api-1/">Butler&rsquo;s API</a>. A sample schedule file is included in the GitHub repository. Schedules added using the API will be stored in the schedule YAML file referenced in the main Butler config file.</li>
</ul>
<p>The two supported schedule formats look like this:</p>
<pre><code>    ┌───────────── seconds (0 - 59)
    │ ┌───────────── minute (0 - 59)
    │ │ ┌───────────── hour (0 - 23)
    │ │ │ ┌───────────── day of the month (1 - 31)
    │ │ │ │ ┌───────────── month (0 - 11)
    │ │ │ │ │ ┌───────────── day of the week (0 - 6) (Sunday to Saturday)
    │ │ │ │ │ │
    * * * * * *
</code></pre>
<p>Valid cron patterns are:</p>
<pre><code>    Asterisk. E.g. *
    Ranges. E.g. 1-3,5
    Steps. E.g. */2
</code></pre>
<p>There are quite a few online tools for creating cron patterns, for example <a href="https://crontab.guru/">crontab.guru</a> and <a href="https://crontab-generator.org/">crontab-generator</a>.</p>
<p>Using a tool like these can save some time when setting things up, but keep in mind that most online tools use minutes as the smallest unit. Some manual tweaking might thus be needed before using the generated pattern in Butler&rsquo;s scheduler.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-2eacc0a085abb47e5414dfd9fb8120b3">3 - Failed/aborted reloads</h1>
    <div class="lead">Overview of the actions Butler can take when a reload task fails or is aborted.</div>
	<p>Below follows a list of destinations to which Butler can send notifications when a reload task fails or is aborted.</p>
<p>A comparison of the different alert destinations can be found <a href="/docs/getting-started/setup/reload-alerts/#alert-destinations-and-options">here</a>.</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-b122b0663c6199cf05ed239edede06e7">3.1 - Alert emails</h1>
    <div class="lead">Overview of the various kinds of alert emails Butler can send.</div>
	<h2 id="scheduled-vs-manual-app-reloads">Scheduled vs manual app reloads</h2>
<p>It might not be obvious at first, but there are several kinds of reloads in Qlik Sense Enterprise on Windows:</p>
<ol>
<li><strong>Reloads started from QMC.</strong> These are usually created and managed in the QMC. Quite often they are also combined into reload chains. The common thing about these reloads is that they - under the hood - are managed by Sense&rsquo;s scheduling service.</li>
<li><strong>Manual reloads started from the script editor.</strong> When developing apps in the standard Sense client/script editor you usually reload the apps from there. This does trigger an app reload, but not via the Sense scheduling service. Instead the reload is done directly in the engine service.</li>
</ol>
<p>The reload failure notifications described here work by looking at log entries written by the scheduling service. When that service writes information to the logs about a failed reload, your logging appender will detect it and send a UDP message to Butler - who will forward the message to all the notification destinations configured in the config file.</p>
<p>It&rsquo;s also possible to have the log appender send emails without using Butler.
It works perfectly fine, but the emails will be very basic when it comes to formatting and you will not get any of the features offered by Butler (last few lines of the reload script log included in the email, customizable email subjects etc).</p>
<h2 id="alert-emails">Alert emails</h2>
<p>Butler can send two kinds of alert emails:</p>
<ul>
<li>When a scheduled reload task fails.</li>
<li>When a running reload task is stopped.</li>
</ul>
<p>Alert emails can be formatted using HTML, use CSS styling, emojis etc.<br>
There&rsquo;s no reason an alert email can&rsquo;t look good!</p>
<p>Alert emails viewed on a mobile phone give direct insight into what has happened:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>






<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 283px">
	<img class="card-img-top" src="/docs/concepts/failed-reloads/alert-emails/reload-fail-alert-email-mobile-1_hu4db7033860926d00b760f31fa6e519f7_495784_600x600_fit_catmullrom_3.png" width="273" height="600">
	
	<figcaption class="card-body px-0 pt-2 pb-0">
		<p class="card-text">Failed reload alert email on mobile home screen.</p>
	</figcaption>
	
</figure>
</td>
<td>






<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 283px">
	<img class="card-img-top" src="/docs/concepts/failed-reloads/alert-emails/reload-fail-alert-email-mobile-2_hu00edd26148aa6620913d66039b3ac1b8_473599_600x600_fit_catmullrom_3.png" width="273" height="600">
	
	<figcaption class="card-body px-0 pt-2 pb-0">
		<p class="card-text">Failed reload alert email viewed on mobile.</p>
	</figcaption>
	
</figure>
</td>
</tr>
</tbody>
</table>
<p>In a regular email client a reload failed email could look like below.</p>
<p><em><strong>Note the end of the script</strong></em> - the last few lines of the reload log are often very useful when it comes to understanding what caused the reload failure.</p>
<p><img src="failed_reload_email_1.png" alt="alt text" title="Reload failed alert email"></p>
<h3 id="basic-alert-emails-also-possible">Basic alert emails also possible</h3>
<p>Qlik Sense Enterprise on Windows uses the log4net logging framework to create log files. Log4net is quite flexible and can - among other things - send emails when events such as reload failures occur. There is however little flexibility when it comes to layout and contents of those emails. They are text only (no formatting, tables, different fonts, colors etc) and the email subjects cannot contain any dynamic fields (for example the name of the failed reload task).</p>
<p>The goal of Butler&rsquo;s alert emails is to address these limitations and offer a flexible foundation not only for emails, but for all kinds of alerts.</p>
<p>If you want to explore what&rsquo;s possible using just the features offered by log4net, Christof Schwarz has a <a href="https://www.linkedin.com/pulse/qlik-sense-task-email-notifications-so-easy-christof-schwarz/?trackingId=X8MEGEmppfSvdukFRbnLwQ%3D%3D">good post</a> on sending basic notification emails when scheduled reloads fail, with links to <a href="https://github.com/levi-turner/getting_notified_from_qliksense">Levi Turner&rsquo;s great examples</a>.</p>
<h2 id="alert-emails-to-app-owners">Alert emails to app owners</h2>
<p>Qlik Sense can be configured in many ways. In some companies all apps are owned by a central service account.<br>
Other companies set the developer as app owner also for published apps.</p>
<p>In the latter case it might be relevant to send the app owner a notification email when a reload task fails or is aborted. That way the developer is immediately made aware of the issue and can act on it as needed.</p>
<p>This feature assumes the app owner&rsquo;s user account (in the Sense user directory) has an email address associated with it. When syncing users from Active Directory the users&rsquo; emails are often brought along into Sense, but there is no guarantee for this.</p>
<p><em>If</em> an email address is available for a Sense user, the QMC user section can look like this:</p>
<p><img src="./qlik_sense_user_email_address_1.png" alt="Email address available for Qlik Sense user" title="Email address available for Qlik Sense user"></p>
<h2 id="alert-emails-only-for-some-tasks">Alert emails only for some tasks</h2>
<p>Sometimes there is a desire to only have email alerts for <em>some</em> tasks.<br>
One example can be a Sense cluster that hosts both development and production apps, maybe separated on different servers.</p>
<p>As of Butler 7.4.0 it is possible to control per task if an alert email should be sent when the task fails or is aborted from the QMC.</p>
<p>Conceptually it works like this:</p>
<p><img src="/img/butler-alert-emails-on-off-per-task-1.png" alt="Switching alert emails on/off per reload task" title="Switching alert emails on/off per reload task"></p>
<p>Instructions for how to configure this feature is available <a href="/docs/getting-started/setup/reload-alerts/alert-emails/#send-alerts-only-for-some-tasks">here</a>.</p>
<p>Note: This feature is similar to - but independent from - the &ldquo;task specific email recipients&rdquo; feature below. Either feature can be enabled or disabled independently of the other in Butler&rsquo;s config file.</p>
<h2 id="task-specific-email-recipients">Task specific email recipients</h2>
<p>They may be cases where all alert emails should normally go to for example a Sense administrator, but <em>some</em> alerts should instead (or also) go to some other recipients.</p>
<p>An example could be a sales related Sense app. If it fails reloading the standard alert email should go to the Sense administrator, but there should also be an alert email sent to the sales operations team, to notify them that they won&rsquo;t find updated numbers in the Sales app.</p>
<p>Butler handles this scenario by using a custome propperty (its name is configurable in the Butler config file) to set alert email recipients on a per-task basis.</p>
<p>Conceptually it works like this:</p>
<p><img src="/img/butler-different-recipients-alert-emails-1.png" alt="Task specific alert email recipients" title="Task specific alert email recipients"></p>
<p>Instructions for how to configure this feature is available <a href="/docs/getting-started/setup/reload-alerts/alert-emails/#send-alerts-to-specific-people-for-some-tasks">here</a>.</p>
<p>Note: This feature is similar to - but independent from - the &ldquo;alert emails only for some tasks&rdquo; feature below. Either feature can be enabled or disabled independently of the other in Butler&rsquo;s config file.</p>
<h2 id="how-it-works">How it works</h2>
<p>Butler uses a templating engine called <a href="https://handlebarsjs.com/guide/">Handlebars</a>. It is used when sending all kinds of alert emails supported by Butler.</p>
<p>Slack, MS Teams and MQTT messages are currently not using the templating engine - this is however likely to change in coming Butler versions. Feel free to <a href="https://github.com/ptarmiganlabs/butler/issues">add (or +1) a request on GitHub</a> if this is of interest to you!</p>
<p><img src="/img/butler-log4net-appenders-1.png" alt="Butler high level system overview" title="Butler high level system overview"></p>
<h3 id="template-fields">Template fields</h3>
<p>The Handlebars templating engine looks for <em>template fields</em> in the template files you create.</p>
<p>A complete list of template fields - including descriptions - is available in the <a href="/docs/reference/alert-template-fields">Reference</a> section.</p>
<h3 id="not-all-failed-reloads-will-cause-alert-emails">Not all failed reloads will cause alert emails</h3>
<p>While not obvious at first, there are different kinds of reloads taking place in a Qlik Sense Enterprise environment:</p>
<ul>
<li>
<p>Reloads started by the Sense Scheduler service. These reloads always have a <em>task</em> associated with them.</p>
</li>
<li>
<p>Reloads started from Sense&rsquo;s standard script editor. These reloads are <em>not</em> started by the Sense scheduler, but rather directly in the Sense engine. Progress for such reloads will therefore go to the <em>engine logs</em>.</p>
</li>
</ul>
<p>The log appenders that drive Butler&rsquo;s alerts rely on the Scheduler logs - not the engine logs.<br>
This is an intentional design decision.</p>
<p>It is certainly possible to add log appenders also for engine logs and that way get notified when <em>any</em> reload fail. The question is whether that&rsquo;s an interesting use case. In most cases sys admins aren&rsquo;t very interested in reloads that fail during app development - they only care about failures caused by apps in production - i.e. app reload tasks managed by the Sense Scheduler. Thus, Butler currently doesn&rsquo;t deal with reload failures reported from the Sense engine.</p>
<h2 id="references">References</h2>
<ul>
<li>
<p><a href="https://help.qlik.com/en-US/sense-admin/September2020/Subsystems/DeployAdministerQSE/Content/Sense_DeployAdminister/QSEoW/Deploy_QSEoW/Server-Logging-Using-Appenders.htm">Qlik&rsquo;s documenation</a> around log appenders and how to hook into the Sense logs is somewhat brief, but does provide a starting point if you want to dive deeper into this topic.</p>
</li>
<li>
<p>The main <a href="https://logging.apache.org/log4net/">log4net documentation</a> (log4net is the logging framework used by Qlik Sense Enterprise) can also be useful.</p>
</li>
</ul>
<p>These links describe how emails can be sent from the log4net logging framework itself, directly to the recipient. Butler includes sameple XML files for this use case too, but Butler takes things further by using the data in the Sense logs to pull in more data around the failed or stopped reload.</p>
<p>In other words - Butler&rsquo;s alert emails are significantly more flexible and contain information (such as script logs) that are not availble using purely log4net.</p>
<h2 id="seeing-is-believing">Seeing is believing</h2>
<p>The video below is available at <a href="https://www.youtube.com/channel/UCpQblhippq-KfWkXEEYFHTQ">Ptarmigan Labs&rsquo; YouTube channel</a> and also in the <a href="https://www.youtube.com/playlist?list=PLUuyY5OOOsz3XX5YT2QEwa7dzaBT1kOCP">Butler playlist</a>.</p>
<div class="embed-responsive embed-responsive-16by9">
        <iframe src="https://www.youtube.com/embed/PxYGtCmpu4o?enablejsapi=1"
                 allowfullscreen></iframe>
</div>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a50a38f6834b0485b50aa321ea429862">3.2 - Alerts via Slack and Microsoft Teams</h1>
    <div class="lead">Sending alerts to IM services like Slack and Microsoft Teams can be a great way to quickly notify people about urgent issues.</div>
	<h2 id="teams-slack-and-email-notifications">Teams, Slack and email notifications</h2>
<p>Microsoft Teams, Slack and email are all notification <em><strong>destinations</strong></em>.</p>
<p>Alert messages/notifications come in two variants: &ldquo;basic&rdquo; and &ldquo;formatted&rdquo;.</p>
<h3 id="formatted-messages">Formatted messages</h3>
<p>These messages take full advantage of the formatting available in each notification destination.</p>
<p>Slack has its own way for creating messages with rich layout and formatting - as does Teams and email.</p>
<p>Formatted messages are created using template files.<br>
Each notification destination has its own set of template files. It&rsquo;s therefore possible to take advantage of each destination&rsquo;s specific features when it comes to formatting the messages sent by Butler.</p>
<p>Message templates can include &ldquo;template fields&rdquo;. These are placeholders that are replaced with actual event values before the message is sent.</p>
<p>The GitHub repository includes fully functional template files for all destinations.</p>
<h3 id="basic-messages">Basic messages</h3>
<p>Basic message formats are available for all notification destinations.</p>
<p>This message type is useful if you only want a short, basic notification that a task failed or was aborted. The basic formats are pre-defined and are thus easy to set up.</p>
<h2 id="microsoft-teams-notifications">Microsoft Teams notifications</h2>
<p>Basic and formatted reload task failure notifications can look like this in Teams:</p>
<p><img src="/img/failed-reload-teams-basic_1.png" alt="alt text" title="Basic failed reload notification in Microsoft Teams"></p>
<p><img src="/img/failed-reload-teams-formatted_1.png" alt="alt text" title="Formatted failed reload notification in Microsoft Teams"></p>
<p>The configuration needed for setting this up is described <a href="/docs/getting-started/setup/reload-alerts/alert-teams/">here</a>.</p>
<h2 id="slack-notifications">Slack notifications</h2>
<p>Basic and formatted reload task failure notifications can look like this in Teams:</p>
<p><img src="/img/failed-reload-slack-basic_1.png" alt="alt text" title="Basic failed reload notification in Microsoft Teams"></p>
<p><img src="/img/failed-reload-slack-formatted_1.png" alt="alt text" title="Formatted failed reload notification in Microsoft Teams"></p>
<p>The configuration needed for setting this up is described <a href="/docs/getting-started/setup/reload-alerts/alert-slack/">here</a>.</p>
<h2 id="seeing-is-believing">Seeing is believing</h2>
<p>The video below is available at <a href="https://www.youtube.com/channel/UCpQblhippq-KfWkXEEYFHTQ">Ptarmigan Labs&rsquo; YouTube channel</a> and also in the <a href="https://www.youtube.com/playlist?list=PLUuyY5OOOsz3XX5YT2QEwa7dzaBT1kOCP">Butler playlist</a>.</p>
<div class="embed-responsive embed-responsive-16by9">
        <iframe src="https://www.youtube.com/embed/PxYGtCmpu4o?enablejsapi=1"
                 allowfullscreen></iframe>
</div>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-1487bc32760b32de8c233d20e06b2981">3.3 - Storing script logs of failed reloads to disk</h1>
    <div class="lead">When investigating reload failures it can often be useful to have access to the entire reload log.<br> Butler detects failed reloads and can store the entire reload log into easy to find and analyse files on disk.</div>
	<h2 id="reload-script-logs">Reload script logs</h2>
<p>When doing a scheduled reload or a reload started from the QMC, Sense will create a detailed log file that includes all the commands executed during the reload.</p>
<p>If a reload for reason fails it can be very useful to look at these reload logs.</p>
<p>The <em>latest</em> reload log file for each reload task is available via the QMC, but logs for previous reload attempts are not available via the QMC.</p>
<p>Using the same mechanism used by <a href="/docs/concepts/alert-emails/">reload failure alerts</a> in general, Butler can be configured to store the reload logs of all failed reloads to disk.</p>
<p>The reload logs are stored in the directory configured in the Butler config file, with separate directories for each date:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>.
</span></span><span style="display:flex;"><span>├── butler.exe
</span></span><span style="display:flex;"><span>├── log
</span></span><span style="display:flex;"><span>│   └── butler.2022-04-07.log
</span></span><span style="display:flex;"><span>├── production.yaml
</span></span><span style="display:flex;"><span>└── scriptlog
</span></span><span style="display:flex;"><span>    ├── 2022-04-06
</span></span><span style="display:flex;"><span>    │   ├── 2022-04-06_15-36-12_appId<span style="color:#ce5c00;font-weight:bold">=</span>deba4bcf-47e4-472e-97b2-4fe8d6498e11_taskId<span style="color:#ce5c00;font-weight:bold">=</span>0d815a99-1ca3-4131-a398-6878bd735fd8.log
</span></span><span style="display:flex;"><span>    │   └── 2022-04-06_22-42-35_appId<span style="color:#ce5c00;font-weight:bold">=</span>66bc109d-286a-415b-8355-1422abb22133_taskId<span style="color:#ce5c00;font-weight:bold">=</span>e959f40a-67be-4a5b-ae83-a292f96ba078.log
</span></span><span style="display:flex;"><span>    └── 2022-04-07
</span></span><span style="display:flex;"><span>        └── 2022-04-07_05-49-16_appId<span style="color:#ce5c00;font-weight:bold">=</span>deba4bcf-47e4-472e-97b2-4fe8d6498e11_taskId<span style="color:#ce5c00;font-weight:bold">=</span>0d815a99-1ca3-4131-a398-6878bd735fd8.log
</span></span></code></pre></div><p>All in all this makes it a lot easier to find log files for failed reloads.</p>
<p>Configuration of this feature is described <a href="/docs/getting-started/setup/reload-script-logs/">here</a>.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-2572b5d0bb912bb2fe6598f2112aa5c4">3.4 - InfluxDB</h1>
    <div class="lead">Storing information about failed reloads in InfluxDB can be useful for monitoring and analysis purposes.<br>
Once the data is in InfluxDB it can be visualized in Grafana or similar tools.</div>
	<h2 id="visualising-failed-reloads-in-grafana">Visualising failed reloads in Grafana</h2>
<p>When a reload fails, Butler can send information about the failed reload to InfluxDB.<br>
The data stored in InfluxDB is described <a href="/docs/reference/influxdb/#failed-reload-tasks">here</a>.</p>
<p>Once the data is in InfluxDB it can be visualized in Grafana or similar tools.<br>
Grafana has a good log viewer that can be used to visualize the data.</p>
<p>Note how even the script log is stored in InfluxDB, so you can see the last few lines of the reload script log in Grafana.<br>
This makes it easy to right away see what went wrong, especially when dealing with reloads that happened a while back.</p>
<p><img src="/img/failed-reload-log-in-grafana-1.png" alt="Failed reload task visualised in Grafana" title="Failed reload task visualised in Grafana"></p>
<h2 id="configuration">Configuration</h2>
<p>Configuration of this feature is described <a href="/docs/getting-started/setup/reload-alerts/">here</a>.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-bb0b42e65c84552525f295e8402fc090">3.5 - New Relic</h1>
    
	<h2 id="view-reload-alerts-in-new-relic">View reload alerts in New Relic</h2>
<p>When investigating reload failures it can often be useful to have access to the entire reload log, as this usually tells immediately what went wrong.<br>
Butler forwards a very comprehensive set of data to New Relic when a reload fails, including the failing part of the app&rsquo;s script.</p>
<p>This means that companies using New Relic as their enterprise monitoring solution can now also use it to monitor their Qlik Sense reloads, as well as all the Sense real-time metrics provided by Butler&rsquo;s sibling tool <a href="https://butler-sos.ptarmiganlabs.com">Butler SOS</a>.</p>
<p>As of this wrtiting, New Relic also offers a free tier that will be more than enough for most Butler users.<br>
It is thus possible to get started with monitoring Sense reloads in New Relic without any additional cost.</p>
<p>More information about how Butler integrates with New Relic can be found <a href="/docs/concepts/incident-mgmt-tools/new-relic/">here</a>.</p>
<h2 id="configuration">Configuration</h2>
<p>Configuration of this feature is described <a href="/docs/getting-started/setup/incident-mgmt-tools/new-relic/">here</a>.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ae3289abc4fde74201ada2090f471d10">3.6 - MQTT</h1>
    
	<h2 id="mqtt-as-unified-message-bus">MQTT as unified message bus</h2>
<p>When a reload fails, Butler can send information about the failed reload to an MQTT broker.</p>
<p>MQTT is a lightweight messaging protocol that is commonly used in IoT applications, but it is a mature and versatile protocol that can be used in many different scenarios.</p>
<p>In short, MQTT works by having a broker that clients can connect to. Clients can publish messages to the broker, and clients can subscribe to messages from the broker.<br>
This makes MQTT a great way to integrate different systems in a publish/subscribe pattern.</p>
<p>By sending information about failed reloads to an MQTT broker, Butler can be integrated with any system that can consume MQTT messages - which is a lot of systems.</p>
<p>The information included in the MQTT message is described <a href="/docs/getting-started/setup/reload-alerts/alert-mqtt/">here</a>.</p>
<p>Here is an example of how the information about a failed reload can be viewed in MQTT Explorer:</p>
<p><img src="/img/failed-reload-mqtt-explorer-1.png" alt="Information about a failed reload, viewed in MQTT Explorer" title="Information about a failed reload, viewed in MQTT Explorer"></p>
<h2 id="configuration">Configuration</h2>
<p>Configuration of this feature is described <a href="/docs/getting-started/setup/mqtt/">here</a>.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-da76efdcdc38f4b3df6afb92ec23202c">3.7 - Signl4</h1>
    <div class="lead">Signl4 is a mobile alerting app that offers an easy way to get started with monitoring and alerting in general,<br> including Qlik Sense reloads via Butler&rsquo;s integration with Signl4.</div>
	<h2 id="mobile-alerting">Mobile alerting</h2>
<p>Signl4 has a great mobile app that can be used to receive reload-failed alerts from Butler.</p>
<p>It can look something like this:</p>
<p><img src="/docs/concepts/incident-mgmt-tools/signl4/signl4-4.jpg" alt="Reload failed alerts in Signl4 mobile app" title="Reload failed alerts in Signl4 mobile app"></p>
<p>More information about how Butler integrates with Signl4 can be found <a href="/docs/concepts/incident-mgmt-tools/signl4/">here</a>.</p>
<h2 id="configuration">Configuration</h2>
<p>Configuration of this feature is described <a href="/docs/getting-started/setup/incident-mgmt-tools/signl4/">here</a>.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-047e1db6b8a4141a89e5a2106def9fa3">3.8 - Webhooks</h1>
    <div class="lead">Webhooks provide a generic way to send information about failed/aborted reloads to any system that can receive HTTP POST/PUT/GET requests.<br></div>
	<h2 id="when-nothing-else-works">When nothing else works</h2>
<p>Webhooks may be somewhat limited in terms of what they can do, but their simplicity is also their strength.</p>
<p>When you need to send information about failed/aborted reloads to a system that doesn&rsquo;t have a dedicated integration with Butler, webhooks may be a good solution.</p>
<p>Butler offers a lot of flexibility in terms of how each webhook is configured.<br>
You can&hellip;</p>
<ul>
<li>specify the URL to send the webhook to.</li>
<li>specify the HTTP method to use (POST, PUT, GET).</li>
<li>use htto or https.</li>
<li>specify if a custom certificate should be used.
In this case the root CA certificate is provided to Butler per webhook, which means Butler can be integrated to many systems, each using their own self-signed certificate.</li>
<li>specify if an untrusted certificate should be accepted.
This is useful when integrating with systems that use self-signed certificates and you don&rsquo;t have access to the root CA certificate.</li>
</ul>
<p>Sending reload-failed informnation to a GET http webhook provided by Node-RED can look like this in the Node-RED editor:</p>
<p><img src="/img/webhook-node-red-1.png" alt="Webhook in Node-RED" title="Webhook in Node-RED"></p>
<h2 id="configuration">Configuration</h2>
<p>Configuration of this feature is described <a href="/docs/getting-started/setup/reload-alerts/alert-webhook-out/">here</a>.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-69e2de1d5353f0be5eeaaa13f72505af">4 - Successful reloads</h1>
    <div class="lead">Tracking successful reloads can be useful for various reasons, for example knowing how long different app reloads takes on average.</div>
	<h2 id="whats-this">What&rsquo;s this?</h2>
<p>Butler can optionally track successfully completed reload tasks.</p>
<p>Historically few Sense admins have probably paid much attention to successful reloads (but rather looked at failed ditto), but from a performance planning perspective it&rsquo;s relevant to also monitor successful reloads.</p>
<h2 id="monitoring-some-successful-reloads-or-all">Monitoring some successful reloads or all</h2>
<p>Butler can be configured to track all successful reloads, or only those that have a specific custom property set.<br>
This can be useful if you want to track successful reloads for some apps but not others.</p>
<ul>
<li>To enable this feature for all reload tasks, set <code>Butler.influxDb.reloadTaskSuccess.allReloadTasks.enable</code> to <code>true</code>.</li>
<li>To enable this feature for only some reload tasks, set <code>Butler.influxDb.reloadTaskSuccess.byCustomProperty.enable</code> to <code>true</code>.<br>
This setting will have no effect if <code>Butler.influxDb.reloadTaskSuccess.allReloadTasks.enable</code> is set to <code>true</code>.</li>
<li>The name of the custom property is configured in the Butler config file, <code>Butler.influxDb.reloadTaskSuccess.byCustomProperty.customPropertyName</code>.</li>
<li>The value of the custom property that will enable per-task-tracking is found in <code>Butler.influxDb.reloadTaskSuccess.byCustomProperty.enabledValue</code>.</li>
</ul>
<h2 id="using-tags">Using tags</h2>
<p>Both Sense apps and reload tasks can have tags attached to them (set in the QMC).<br>
Butler can be configured to get these tags and include them in the data sent to the enabled destinations.</p>
<p>In the case of InfluxDB the Sense tags will be sent as InfluxDB tags, which means they can be used to filter data in InfluxDB queries and Grafana dashboards.</p>
<p>The config file also allows for adding static tags to the data sent to InfluxDB, this is set in <code>Butler.influxDb.reloadTaskSuccess.tag.static</code>.</p>
<h2 id="grafana-dashboards">Grafana dashboards</h2>
<p>Given the information stored in InfluxDB, several interesting Grafana dashboards can be created:</p>
<ul>
<li>Distribution of reload durations. If filtering on a specific reload task this will show how much the task duration vary. Can be very useful when investigating server performance problems.</li>
<li>Number of successful reloads per (for example) 15-minute blocks. This shows how reloads are distributed over the course of a day, and can be useful when deciding when to schedule reloads.</li>
</ul>
<p>Sample dashboard showing the above charts:</p>
<p><img src="./butler-grafana-successful-reloads-1.png" alt="alt text" title="Grafana reload success"></p>
<p>Here is another set of charts, also showing what metadata is available for each reload task:</p>
<p><img src="./butler-grafana-successful-reloads-2.png" alt="alt text" title="Grafana reload success"></p>
<h2 id="how-it-works">How it works</h2>
<h3 id="reload-success-udp-server">Reload success UDP server</h3>
<p>Butler includes a UDP server to which Sense&rsquo;s logging framework Log4Net can send reload success messages.</p>
<p>The UDP server is configured in the Butler config file, and is disabled by default.
When enabled, the UDP server listens for UDP messages on the configured port.</p>
<p>When a UDP message is received, the UDP server will parse the message to determine what it is about and to extract relevant data, then dispatch the message to the enabled destinations.<br>
The XML appenders must be correctly deployed on the Sense servers for this to work.<br>
See <a href="/docs/getting-started/setup/reload-alerts/#adding-a-log-appender">this page</a> for more information on setting up the XML appenders.</p>
<p>In the case of successful reload tasks, the UDP server will determine which app was reloaded, the duration of the reload task, who started the task etc.<br>
Butler will then send this information to the enabled destinations.</p>
<h2 id="supported-destinations">Supported destinations</h2>
<p>The following destinations are supported:</p>
<ul>
<li>InfluxDB</li>
</ul>
<h3 id="config-file-settings">Config file settings</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">Butler</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...          </span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># InfluxDB settings</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">influxDb</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># Master switch for InfluxDB integration. If false, no data will be sent to InfluxDB.</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">reloadTaskSuccess</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">allReloadTasks</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">byCustomProperty</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">customPropertyName</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;Butler_SuccessReloadTask_InfluxDB&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">enabledValue</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;Yes&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">tag</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> 
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">static</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># Static attributes/dimensions to attach to events sent to InfluxDb</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># - name: event-specific-tag 1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic">#   value: abc 123</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">dynamic</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">useAppTags</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># Should app tags be sent to InfluxDb as tags?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">useTaskTags</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">     </span><span style="color:#8f5902;font-style:italic"># Should task tags be sent to InfluxDb as tags?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...          </span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div>
</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-058a8f0a0aec0d9c7e790ea7fc82eb79">5 - Starting Sense tasks in style</h1>
    <div class="lead">Starting Sense reload tasks (and other tasks) is usually done from the QMC.<br> Using Butler&rsquo;s REST API it&rsquo;s however very easy to start tasks from any third party system capable of making a REST call.</div>
	<h2 id="whats-wrong-with-starting-tasks-from-the-qmc">What&rsquo;s wrong with starting tasks from the QMC?</h2>
<p>Nothing really. At least not if starting tasks is considerd a manual activity.</p>
<p>There are also scenarios that benefit from automation.<br>
Consider a Sense environment that gets its data from some source system, for example a financial ERP system.:</p>
<p><strong>Sense could poll that source system for data ever so often - or the source system could start the needed tasks when new data is available.</strong></p>
<p>Or simply: Notifications are usually (always?) a better solution than polling for new data.</p>
<p>The good news is that Butler includes solid support for starting Sense tasks from 3rd party systems.</p>
<p>Below the concept is described on a high level.<br>
Actual examples are available <a href="/docs/examples/start-task/start-task-from-rest/">here</a>.</p>
<h2 id="start-tasks-by-ids-tags-and-custom-properties">Start tasks by IDs, tags and custom properties</h2>
<p>Butler&rsquo;s <code>/v4/reloadtask/&lt;taskid&gt;/start</code> API endpoint is used to start tasks.<br>
For historical reasons there are two variants: POST and PUT. Both do the exactly the same though.</p>
<p>The general idea of this API is</p>
<ul>
<li><strong>One</strong> task should be started. The task is <strong>identified by its task ID</strong>.<br>
Done using just a properly formatted URL. This is usually the most common scenario.</li>
<li><strong>More than one</strong> task should be started. The tasks are <strong>identified by their IDs</strong>.<br>
The first task can be specified in the URL and the rest in an array in the call&rsquo;s body.<br>
Or all task IDs can be specified in the call&rsquo;s body.</li>
<li><strong>One or more tasks</strong> should be started. The tasks are <strong>identified by tags</strong> set in the QMC.<br>
The tags are specified in the call&rsquo;s body.<br>
All tasks having the tags included in the call will be started.</li>
<li><strong>One or more tasks</strong> should be started. The tasks are <strong>identified by custom property values</strong> set in the QMC.<br>
Same principle as for tags, but using custom properties instead.<br>
All tasks having the custom property/value combinations in the call will be started.</li>
</ul>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Remember</h4>

    <p>Task IDs are permanent for a specific task, but if tasks are re-created they will get new task IDs.</p>
<p>By specifying tasks using tags and/or custom properties instead, the outside systems that need to start tasks don&rsquo;t have to deal with task IDs that may change.</p>
<p>Lower risk for issues and less maintenance thus.</p>


</div>

<h3 id="start-tasks-by-id">Start tasks by ID</h3>
<p>While this may be the most obvious way to control what task(s) should be started, it requires the caller to know the exact ID of the task of interest.<br>
If the task for some reason is re-created its ID will change.</p>
<p>Still, there are certainly cases where task IDs are relevant and the easiest option to use and set up.</p>
<p><img src="start-tasks-using-taskid-1.png" alt="alt text" title="Finding task IDs in the QMC"></p>
<h3 id="start-tasks-by-tags">Start tasks by tags</h3>
<p>Given the example below, <strong>a single call</strong> to Butlers API could start all four of the tasks tagged <code>Butler 5.0 demo</code>.<br>
Or the three tasks tagged <code>startTask1</code>.<br>
Or all of those tasks, if both tags were passed to the Butler API.</p>
<p><img src="start-tasks-using-tag-1.png" alt="alt text" title="Finding tags in the QMC"></p>
<h3 id="start-tasks-by-custom-properties">Start tasks by custom properties</h3>
<p>Using custom properties to identify which tasks to start works similarly to how tags are used (see above).<br>
The main difference is that the caller must know the name of the custom property and at least one of the possible values for that custom property, in order to start the associated task.</p>
<p>In the example below, calling the Butler API with parameters <code>taskGroup=tasks2</code> would result in all tasks having the <code>taskGroup</code> custom property set to <code>tasks2</code> to be started.</p>
<p><img src="start-tasks-using-cp-1.png" alt="alt text" title="Finding a task's custom property values in the QMC"></p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f6643c486e610f90387a66f5864c5f88">6 - Incident management tools</h1>
    <div class="lead">There are various enterprise grade tools for handling IT incidents. Butler can integrate with such tools, for example forwarding information about failed reloads to an IT operations team.</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-5c7b057bc2c2752268a343fe42ce5775">6.1 - New Relic</h1>
    <div class="lead">New Relic is an enterprise grade observability solution in a SaaS package.  <br><br>They offer a uniform approach to dealing with metrics, logs and events - including a basic but working alert management feature. <br><br> The service is easy to get started with and has a generous free tier that works well for testing Butler alerts. <br>New Relic is a good choice for both metrics storage and alerting as it handles both reload failure alerts generated by the Butler tool as well as operational metrics from <a href="https://butler-sos.ptarmiganlabs.com">Butler SOS</a>.</div>
	<p>New Relic is not primarily an incident management tool, but rather a complete SaaS platform for handling metrics, logs, events and trace messages.</p>
<p>Their event handling however has some alert handling features built in, and these can be nicely integrated with Butler and Qlik Sense.<br>
Furthermore, New Relic also integrates with several dedicated incident manamgenet tools (PagerDuty, VictorOps, OpsGenie and others) and also other notification channels such as Slack, Teams, email, and generic webhooks.<br>
Toghether these capabilities makes New Relic a very good match to the features offered by Butler and Butler SOS.</p>
<p>The concept looks like this:</p>
<ol>
<li>Alerts (for example a reload task fails in Qlik Sense) are sent to New Relic using their event and log APIs.<br>
Butler integrates tightly with those APIs, creating a seamless, almost instantaneous forwarding of incidents.</li>
<li>Metadata about the failed or aborted reload task and associate Sense app is sent to New Relic together with the last parts of the reload script log.<br>
The script log can then be viewed from within New Relic&rsquo;s web interface and usually provides instant insight into what caused the reload to fail.</li>
<li>As part of the setup process, &ldquo;alert conditions&rdquo; are created in New Relic. These define when New Relic alerts should be created, given the event data sent from Butler.</li>
<li>New Relic &ldquo;alert policies&rdquo; are used to group together several conditions and also associate notification channels (Slack, Teams, PagerDuty, &hellip;) to each alert policy.</li>
<li>New Relic incidents stay in an open state until they are acknowledged, which can be done from the web interface or from within email or Teams/Slack messages.</li>
</ol>
<p>The <a href="/docs/getting-started/setup/incident-mgmt-tools/new-relic/">Getting started section</a> has hands-on instructions for setting up Butler to work with New Relic.</p>
<h2 id="new-relic-screen-shots">New Relic screen shots</h2>
<p>Sample New Relics dashboards are found below.</p>
<p>Please note that some of the charts (server RAM, CPU, user sessions etc) in these dashboards use data from Butler SOS.<br>
Butler provides data for failed/aborted reloads tables and charts.</p>







<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1006px">
	<img class="card-img-top" src="/docs/concepts/incident-mgmt-tools/new-relic/new-relic-dashboard-1_hu48ad02a06a5a48454f6fc0abc1638707_603480_0x640_resize_catmullrom_3.png" width="996" height="640">
	
	<figcaption class="card-body px-0 pt-2 pb-0">
		<p class="card-text"> New Relic metrics & incident dashboard (light mode) </p>
	</figcaption>
	
</figure>








<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1140px">
	<img class="card-img-top" src="/docs/concepts/incident-mgmt-tools/new-relic/new-relic-senseops-1_hue5080e106e013819ec01dca063b0cec7_772873_0x640_resize_catmullrom_3.png" width="1130" height="640">
	
	<figcaption class="card-body px-0 pt-2 pb-0">
		<p class="card-text"> New Relic metrics & incident dashboard (dark mode, different time range than previous dashboard above). </p>
	</figcaption>
	
</figure>








<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1140px">
	<img class="card-img-top" src="/docs/concepts/incident-mgmt-tools/new-relic/new-relic-senseops-2_hu61e65e0680cce0dd7d3e3b98e131878a_961604_0x640_resize_catmullrom_3.png" width="1130" height="640">
	
	<figcaption class="card-body px-0 pt-2 pb-0">
		<p class="card-text"> Detailed information about failed reloads, including the last part of the script log, is available from within New Relic dashboards. </p>
	</figcaption>
	
</figure>








<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1140px">
	<img class="card-img-top" src="/docs/concepts/incident-mgmt-tools/new-relic/new-relic-senseops-3_hue5080e106e013819ec01dca063b0cec7_855196_0x640_resize_catmullrom_3.png" width="1130" height="640">
	
	<figcaption class="card-body px-0 pt-2 pb-0">
		<p class="card-text"> Butler SOS metrics in a dark mode New Relic dashboard. </p>
	</figcaption>
	
</figure>








<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1126px">
	<img class="card-img-top" src="/docs/concepts/incident-mgmt-tools/new-relic/new-relic-alert-overview-1_huca017e540ec50ef68c261f5dbd64c672_486416_0x640_resize_catmullrom_3.png" width="1116" height="640">
	
	<figcaption class="card-body px-0 pt-2 pb-0">
		<p class="card-text"> New Relic incidents overview page (dark mode) </p>
	</figcaption>
	
</figure>








<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1126px">
	<img class="card-img-top" src="/docs/concepts/incident-mgmt-tools/new-relic/new-relic-alert-conditions-1_huca017e540ec50ef68c261f5dbd64c672_449678_0x640_resize_catmullrom_3.png" width="1116" height="640">
	
	<figcaption class="card-body px-0 pt-2 pb-0">
		<p class="card-text"> New Relic alert conditions (dark mode)</p>
	</figcaption>
	
</figure>








<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 2131px">
	<img class="card-img-top" src="/docs/concepts/incident-mgmt-tools/new-relic/new-relic-slack-alert-1_hu03fb9c540c54344a3e0ee19f7817a5cf_219666_0x640_resize_catmullrom_3.png" width="2121" height="640">
	
	<figcaption class="card-body px-0 pt-2 pb-0">
		<p class="card-text"> Basic New Relic Slack alert (dark mode) </p>
	</figcaption>
	
</figure>








<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1108px">
	<img class="card-img-top" src="/docs/concepts/incident-mgmt-tools/new-relic/new-relic-slack-alert-2_hu528289caef6e1eb03d6ff06aca8998be_407785_0x640_resize_catmullrom_3.png" width="1098" height="640">
	
	<figcaption class="card-body px-0 pt-2 pb-0">
		<p class="card-text"> More comprehensive New Relic Slack alert (dark mode) </p>
	</figcaption>
	
</figure>


</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-62f43ebd86994233e80c685703acd08d">6.2 - Signl4</h1>
    <div class="lead">Signl4 describes themselves as  <br><br>&ldquo;Mobile Alerting and Incident Response. Automated Alerting. Anywhere Response&rdquo; <br><br> It&rsquo;s an easy to get started with, SaaS based solution for incident management.<br> It has good APIs and integrations as well as a generous free trial tier, which makes it great for Qlik Sense admins who wants to try a proper incident management tool. <br><br> <a href="https://www.signl4.com">www.signl4.com</a></div>
	<p>Signl4 offers both an online SaaS service and a mobile app.</p>
<p>The concept looks like this:</p>
<ol>
<li>Alerts (for example an important Sense app fails reloading) are sent to Signl4 using their APIs.<br>
Using their API an incident is created.<br>
Butler integrates with these APIs, creating a seamless, almost instantaneous handling of incidents.</li>
<li>The incident is assigned to whoever is on duty at that time. This person (or group of people in larger organisations) will be notified via their Signl4 mobile apps.</li>
<li>The person on duty can acknowledge that an incident is being looked into and eventually also that the incident has been resolved.</li>
<li>If no-one acknowledge the incidient within a configurable time the incident can be escalated.</li>
<li>&hellip; and much more.</li>
</ol>
<p>The <a href="/docs/getting-started/setup/incident-mgmt-tools/signl4/">Getting started section</a> has hands-on instructions for setting up Butler to work with Signl4.</p>
<h2 id="example-qlik-sense-and-signl4-on-android">Example: Qlik Sense and Signl4 on Android</h2>
<div class="embed-responsive embed-responsive-16by9">
        <iframe src="https://www.youtube.com/embed/iC_zbgczvFY?enablejsapi=1"
                 allowfullscreen></iframe>
</div>
<br>
<br>
<br>
<p>Below are screen shots from an Android phone in which the Signl4 mobile app is installed.</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>






<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 370px">
	<img class="card-img-top" src="/docs/concepts/incident-mgmt-tools/signl4/signl4-1_hu502bbcd9147e0361bdddf0aa3faaafbc_162998_360x0_resize_q75_catmullrom.jpg" width="360" height="792">
	
	<figcaption class="card-body px-0 pt-2 pb-0">
		<p class="card-text"> Signl4 message on Android lock screen. </p>
	</figcaption>
	
</figure>
</td>
<td>






<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 370px">
	<img class="card-img-top" src="/docs/concepts/incident-mgmt-tools/signl4/signl4-2_hu18d79376c456c286601acabdf019b347_136457_360x0_resize_q75_catmullrom.jpg" width="360" height="792">
	
	<figcaption class="card-body px-0 pt-2 pb-0">
		<p class="card-text"> Signl4 message on Android lock screen. </p>
	</figcaption>
	
</figure>
</td>
</tr>
<tr>
<td>






<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 370px">
	<img class="card-img-top" src="/docs/concepts/incident-mgmt-tools/signl4/signl4-3_hue02c839b75ab4615bab0e8b36a646528_194639_360x0_resize_q75_catmullrom.jpg" width="360" height="792">
	
	<figcaption class="card-body px-0 pt-2 pb-0">
		<p class="card-text"> Overview of incidents. </p>
	</figcaption>
	
</figure>
</td>
<td>






<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 370px">
	<img class="card-img-top" src="/docs/concepts/incident-mgmt-tools/signl4/signl4-4_hud28b089d7f22295ea3f275d5a8057818_263046_360x0_resize_q75_catmullrom.jpg" width="360" height="792">
	
	<figcaption class="card-body px-0 pt-2 pb-0">
		<p class="card-text"> List of incidents during past 24 hours. </p>
	</figcaption>
	
</figure>
</td>
</tr>
<tr>
<td>






<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 370px">
	<img class="card-img-top" src="/docs/concepts/incident-mgmt-tools/signl4/signl4-5_hu43379b6a402b5a8ae5311cc78fccbe5a_143540_360x0_resize_q75_catmullrom.jpg" width="360" height="792">
	
	<figcaption class="card-body px-0 pt-2 pb-0">
		<p class="card-text"> Incident details. </p>
	</figcaption>
	
</figure>
</td>
<td></td>
</tr>
</tbody>
</table>

</div>



    
      
  
  
  
  

  
  

  

    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-d53b327fc967acd8173b66baaf9430d6">7 - Qlik Sense licenses</h1>
    <div class="lead"><p>Monitor and manage Qlik Sense licenses.</p>
<ul>
<li>High level metrics per user license type (professional, analyzer etc) are gathered and stored in your database of choice (at the time of writing, InfluxDB is supported).</li>
<li>User licenses can be released automatically after a certain period of inactivity, allowing them to be used by other users.</li>
</ul></div>
	<h2 id="monitor-user-licenses">Monitor user licenses</h2>
<p>In order to use Qlik Sense end users must be assigned some kind of access license.<br>
There are different types of licenses, for example Professional, Analyzer and Analyzer Capacity licenses.</p>
<p>Butler can monitor the usage of these licenses and store the data in InfluxDB, from where the license data can be visualized in Grafana.</p>
<p>This makes it easy to track (and alert if needed) on the number of used licenses, how many are available and when it&rsquo;s time to get more licenses.</p>
<h2 id="release-inactive-user-licenses">Release inactive user licenses</h2>
<p>Butler can automatically release Professional and Analyzer user licenses that have been inactive for a certain period of time.</p>
<p>This is useful in environments where some users use Sense sporadically, for example only during certain times of the year.<br>
In such cases it&rsquo;s a waste of resources to keep the license assigned to the user when it&rsquo;s not being used.</p>
<p>Here is how it works:</p>
<ul>
<li>Butler will evaluate allocation of professional and analyzer access licenses on a configurable schedule, for example once per day.</li>
<li>Licenses that have not been used for a certain period of time (e.g. 30 days) will be released.
<ul>
<li>Separate inactivity periods can be configured for professional and analyzer licenses.</li>
</ul>
</li>
<li>Licenses that are within quarantine period will never be released.</li>
<li>It is possible to exclude certain users from having their licenses released, i.e. guarantee they will always have a license available.
Can be useful for administrators or users that need guaranteed access to Sense.
<ul>
<li>The following criteria can be used to exclude users from having their licenses released:
<ul>
<li>Specific users (by userDirectory\userId)</li>
<li>Specific tag(s) assigned to a user.</li>
<li>Specific custom property value(s) assigned to a user.</li>
<li>Users belonging to a user directory.</li>
<li>Users being marked as (not) active in the QMC.</li>
<li>Users being marked as (not) blocked in the QMC.</li>
<li>Users being marked as (not) externally removed in the QMC.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="disclaimer">Disclaimer</h2>
<p>This feature has the potential to let more users use your Sense environment, compared to a scenario where no release of licenses is done.</p>
<p>In order to avoid users not being able to access Sense you should still ensure to have a good margin, i.e. get more licenses from Qlik once you are running low. This is the only (and correct and proper) way to ensure that users are not denied access to Sense due to missing licenses.</p>
<p>Also, you must ensure that managing licenses this way is not in conflict with <em>your</em> license agreement with Qlik.</p>
<p>Butler&rsquo;s license release feature uses <a href="https://help.qlik.com/en-US/sense-developer/February2024/Subsystems/RepositoryServiceAPI/Content/Sense_RepositoryServiceAPI/RepositoryServiceAPI-Reference-Redirect.htm?ref=ptarmiganlabs.com">APIs</a> that are publicly documented by Qlik (example <a href="https://help.qlik.com/en-US/sense-developer/February2024/APIs/RepositoryServiceAPI/index.html?page=126&amp;ref=ptarmiganlabs.com">here</a>).</p>
<p>The same APIs are used by the QMC to release licenses.<br>
Butler simply automates what is otherwise a manual task in the QMC.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-1ac4fd4b7c9bf1db2e94deeef12e64c6">8 - File system access: copy/move/delete files</h1>
    <div class="lead">Manipulating files from Sense load scripts in a secure yet flexible way.</div>
	<h2 id="unrestricted-file-system-access-is-a-security-risk">Unrestricted file system access is a security risk</h2>
<p>Qlik Sense locked down things quite a bit compared to its QlikView predecessor.</p>
<p>In QlikView your app scripts could do almost anything with any file on the server&rsquo;s disks as long as the QlikView service account had access to the file.<br>
This was not ideal from a security perspective and Qlik Sense therefore introduced the concept of <a href="https://help.qlik.com/en-US/sense/August2021/Subsystems/Hub/Content/Sense_Hub/LoadData/connect-data-sources-data-load-editor.htm">folder data connetions</a> and in general much stricter <a href="https://help.qlik.com/en-US/sense/August2021/Subsystems/Hub/Content/Sense_Hub/LoadData/file-system-access-restriction.htm">file system access restrictions</a>.</p>
<p>With this change Qlik Sense had a much better position with respect to security, as access to files was now boxed by the folder data connection the access used (by means of lib:// statements).<br>
It&rsquo;s also possible to <a href="https://help.qlik.com/en-US/sense/August2021/Subsystems/Hub/Content/Sense_Hub/Scripting/SystemVariables/Include.htm">include .qvs script files</a> via the same mechanism.</p>
<p>The problem now is that it&rsquo;s no longer possible to do file level operations on individual or groups of files.<br>
No more deleting, copying or moving of files from within the load script.</p>
<p>Now - there is a per-server setting that disables this new &ldquo;standard mode&rdquo; and reverts back to what&rsquo;s known as &ldquo;legacy mode&rdquo;, which is essentially how QlikView worked (and still works). But then the Sense environment is once again vulerable to badly written or even malicious Sense apps.</p>
<h2 id="butler-adds-controlled-file-system-access-to-qlik-sense-enterprise">Butler adds controlled file system access to Qlik Sense Enterprise</h2>
<p>Butler&rsquo;s solution is to add a set of REST API endpoints for file copy/move/delete operations, but only allow these to operate on pre-defined folders.</p>
<p>For example, you might have a QVD folder at <code>e:\data\qvd\sales\temp</code>.<br>
You also need to remove old QVDs from that folder.</p>
<p>This could be done with scheduled BAT/CMD files or PowerShell scripts, but it might be better/more flexible/easier/preferred to do this cleanup from the load script of a Sense app.</p>
<p>The solution: Add <code>e:\data\qvd\sales\temp</code> to Butler&rsquo;s list of folders in which files can be deleted, then call Butler&rsquo;s <code>/v4/filedelete</code> <a href="/docs/reference/rest-api-1/?operationsSorter=alpha">API endpoint</a> from within your app&rsquo;s load script. Done!</p>
<h2 id="convenience-subs">Convenience subs</h2>
<p>Butler includes a set of Subs that make it easy to use the file copy/move/delete APIs.<br>
These subs are found in <a href="https://github.com/ptarmiganlabs/butler/blob/master/docs/sense_script/butler_subs.qvs">this .qvs file</a> as well as embedded in the <a href="https://github.com/ptarmiganlabs/butler/tree/master/docs/sense_apps">Butler demo app</a>.</p>
<p>The <a href="/docs/examples">examples section</a> shows how to use these subs - or call the Butler APIs directly.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-54cf36a5b3033781aa5a15d5bc3676b6">9 - MQTT integration</h1>
    <div class="lead">Details about how Qlik Sense can use Butler to send pub-sub messages using MQTT.</div>
	<h2 id="what-is-mqtt">What is MQTT?</h2>
<p><a href="https://mqtt.org">MQTT</a> is a light weight publish-subscribe (&ldquo;pub-sub&rdquo;) protocol.</p>
<p>Used in both the telecomms industry and various Internet of Things applications, there are client libraries available for many different languages and platforms. This is important, as there is a good chance other systems can find a way of sending MQTT messages, which Butler can then listen for/subscribe to.</p>
<h2 id="outgoing-mqtt-from-butler-itself">Outgoing MQTT from Butler itself</h2>
<p>If MQTT is enabled, Butler will forward events (reload failed, user opened a session to Sense etc) to MQTT. These events are sent to the MQTT topics defined in the <code>Butler.mqttConfig</code> section of Butler&rsquo;s config file.</p>
<h2 id="outgoing-mqtt---publish">Outgoing MQTT - publish</h2>
<p>Butler can post messages to MQTT topics. The <code>/v4/mqttpublishmessage</code> API endpoint is used for this.<br>
This way Butler can send status information and notifications to other systems, outside of Qlik Sense. Use cases include:</p>
<ul>
<li>
<p>Notify downstream systems that Sense has finished creating some data set that the downstream system depends on.</p>
</li>
<li>
<p>Send debug or trace messages to MQTT instead of to the Sense log. Using a MQTT client (there are multiple ones on both Windows, OSX and Linux) you can then monitor the messages in real time. Very useful during development of tricky Sense load scripts!</p>
</li>
<li>
<p>Start Sense tasks (typically reloads) from the Sense load script. Very useful when you need to trigger a second app reload once the first app&rsquo;s load script reaches some specific point of execution.<br>
This way the scheduling and execution of Sense tasks can be made much more flexible than using the built in QMC scheduler.</p>
<p>Note: While possible to start reload tasks using MQTT, it&rsquo;s usually easier to do this using <a href="/docs/reference/rest-api">Butler&rsquo;s REST API</a>.</p>
</li>
<li>
<p>Send messages to platforms such as Node-RED. Node-RED is an open source platform (with a graphical editor) intended for integrating different systems and data sources. As it is built on node.red there are many different modules available, offering integrations with all sorts of systems and protocols.<br>
Using Node.RED together with Qlik Sense and Butler, it is possible to interface with social media from the Sense load script (send a Tweet when some condition occur during app reload, for example).</p>
</li>
</ul>
<h2 id="incoming-mqtt---subscribe">Incoming MQTT - subscribe</h2>
<p>Butler subscribes to all MQTT messages in the topic specied in the config setting <code>Butler.mqttConfig.subscriptionRootTopic</code>.<br>
Which in MQTT lingo means &ldquo;listen to all messages in the this topic, as well as in any subtopics&rdquo;.</p>
<p>When Butler gets a message as a result of this subscription it is analysed and if the topic matches any of the predefined topics with special meaning, the associated tasks are carried out.</p>
<p>Topics with special meaning are:</p>
<ul>
<li>Start Sense task. The exact topic is defined in config property <code>Butler.mqttConfig.taskStartTopic</code>.<br>
Note that this topic <em>must</em> be a subtopic to the topic specified in <code>Butler.mqttConfig.subscriptionRootTopic</code>!<br>
Starts the Sense task identified by the ID sent in the message body. More info in the <a href="/docs/examples/start-task/start-task-from-mqtt/#use-mqtt-to-start-sense-tasks">examples</a> section.</li>
</ul>
<p>As Butler listens to all messages in the topic tree specified by <code>Butler.mqttConfig.subscriptionRootTopic</code> it can easily be extended with handlers for additional topics.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ea75db05eef40e825410085639630380">10 - UDP client</h1>
    <div class="lead">A basic, stand-alone UDP client is included in Butler.</div>
	<p>Butler includes a very basic UDP client, which can be used to send test messages to Butler&rsquo;s UDP servers.<br>
This can be useful when debugging a Butler server, when adding new UDP handlers etc.<br>
The client is built using node.js, and is found in the src/udp_client directory.</p>
<p>Run the app to show its help text (in this case the UDP client is executed on a Mac):</p>
<pre><code>$ node udp_client.js
Usage: node udp_client.js [options]

This app sends messages to the UDP server(s) built into Butler (or any other UDP
server)

Options:
  --version   Show version number                                      [boolean]
  -i, --ip    IP address of UDP server message will be sent to        [required]
  -p, --port  Port on UDP server                                      [required]
  -m, --msg   Message to send                          [default: &quot;Test message&quot;]
  -h, --help  Show help                                                [boolean]

Missing required arguments: i, p
$
</code></pre>
<h2 id="testing-the-failed-task-udp-server">Testing the failed task UDP server</h2>
<p>Sending a message to port 9998 will test the UDP server responsible for handling task failure messages:</p>
<p>Sending a message to Butler looks like this (with a fake IP address):</p>
<pre><code>$ node udp_client.js --ip 1.2.3.4 -p 9998 -m &quot;Abc;123;456;test&quot;
UDP message sent to 1.2.3.4:9998, 16 bytes.
$
</code></pre>
<p>The resulting Slack message looks like this:</p>
<p><img src="slack_failed_task_1.jpg" alt="alt text" title="Slack failed task"></p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-cd624950aeaafeeed59dd958b408e6b6">11 - Monitor Windows services</h1>
    <div class="lead">Butler can monitor Windows services and send alerts if a service is not running.<br>
Services on multiple servers can be monitored, and Butler can send alerts to destinations such as Slack, Teams, email, webhooks, InfluxDB, New Relic and MQTT.</div>
	

<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Windows only</h4>

    <p>Windows services is obviously a feature only available on computers running Windows.</p>
<p>Butler can be installed on any platform, but the Windows service monitoring feature will only work when Butler is installed on a Windows computer.</p>


</div>

<h2 id="be-the-first-to-know-when-a-service-stops">Be the first to know when a service stops</h2>
<p>If a Sense service stops (for whatever reason), end users will most likely be impacted one way or another.</p>
<p>Maybe apps will not be reloaded with new data, or users will not be able to access the hub or QMC.</p>
<p>Some companies have dedicated teams that monitors the IT infrastructure, but in many cases the Sense platform is monitored by the same team that develops and maintains the Sense apps.</p>
<p>For these teams, it is important to be notified as soon as possible when a Sense service stops - Butler can help with this.</p>
<h3 id="grafana-dashboards-and-alerts">Grafana dashboards and alerts</h3>
<p>Butler can send service related alerts to InfluxDB, and Grafana can then be used to create dashboards and alerts based on the data in InfluxDB.</p>
<p>A Grafana &ldquo;state timeline&rdquo; chart showing the status of Qlik Sense services across 4 servers can look like below.<br>
Note the red bar indicating that all Qlik Sense services were restarted at one point, but also note that a couple of the servers had additional, shorter outages:</p>
<p><img src="./butler-grafana-windows-service-1.png" alt="alt text" title="Grafana Sense services"></p>
<p>With the above in place, Grafana alerts can be created that will trigger when a service stops, sending messages to incident management systems such as PagerDuty, OpsGenie and VictorOps - or to Slack, Teams, email etc.</p>
<h2 id="many-servers-many-services---and-permissions">Many servers, many services - and permissions</h2>
<p>Butler can monitor services on multiple servers, and it can monitor multiple services on each server.</p>
<p>It should be noted though that each check is executed sequentially, so if you have many servers and many services, it will take some time to complete all checks.<br>
This is especially true if you are monitoring services on remote servers, as the latency will add up.</p>
<p>In order to monitor services on remote servers, Butler needs to be able to connect to the remote server using <a href="https://learn.microsoft.com/en-us/windows/win32/wmisdk/user-account-control-and-wmi">WMI</a> (Windows Management Instrumentation).</p>
<p>Long story short, the easiest way to set things up is to make the account used to run Butler a member of the local Administrators group on the remote server.<br>
This should be done on all remote servers that Butler will monitor services on.</p>
<h2 id="how-it-works">How it works</h2>
<p>Butler uses a state machine to keep track of the status of each service.<br>
The available states and the possible transitions between them are:</p>
<p><img src="./butler-windows-service-state-machine-1.png" alt="alt text" title="Butler Windows service state machine"></p>
<p>When a service check reveals that a service has changed state compared to the state stored in the state machine, Butler will send an alert message to the configured destinations.</p>
<p>Note 1: Windows services technically have more states than the ones shown above, but for our use case the above states are sufficient.</p>
<p>Note 2: The state machine is not persisted to disk, so if Butler is restarted it will not remember the state of the services it was monitoring before the restart.</p>
<p>Note 3: The states shown above are the ones used by Butler internally. The actual alert messages sent to the configured destinations may use different wording.</p>
<h3 id="config-file-settings">Config file settings</h3>
<p>The configuration for Windows service monitoring is done in several sections in the Butler config file.</p>
<p>First, the general services configuration section defines</p>
<ul>
<li>Which services should be monitored on what servers.</li>
<li>How often the checks should be executed.</li>
<li>What destinations should receive service related alerts.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">Butler</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Monitor Windows services.</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># This feature only works when Butler is running on Windows Server or desktop.</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># On other OSs service monitoring will be automatically disabled.</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">serviceMonitor</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                         </span><span style="color:#8f5902;font-style:italic"># Main on/off switch for service monitoring</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">frequency</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">every 5 minutes           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># https://bunkat.github.io/later/parsers.html</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">monitor</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:bold">host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;hostname or IP&gt;           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Host name of Windows computer where services are running</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">services</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                         </span><span style="color:#8f5902;font-style:italic"># List of services to monitor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgresql-x64-12      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Posgress/repository db</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">friendlyName</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Repository DB</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">QlikSenseEngineService</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">friendlyName</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Engine</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">QlikSensePrintingService</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">friendlyName</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Printing</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">QlikSenseProxyService</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">friendlyName</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Proxy</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">QlikSenseRepositoryService</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">friendlyName</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Repository</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">QlikSenseSchedulerService</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">friendlyName</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Scheduler</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">QlikSenseServiceDispatcher</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">friendlyName</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Service Dispatcher</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">alertDestination</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># Control to thich destinations service related alerts are sent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">influxDb</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># Send service alerts to InfluxDB</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">newRelic</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># Send service alerts to New Relic</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">email</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                        </span><span style="color:#8f5902;font-style:italic"># Send service alerts as emails</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">mqtt</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                         </span><span style="color:#8f5902;font-style:italic"># Send service alerts as MQTT messages</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">teams</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                        </span><span style="color:#8f5902;font-style:italic"># Send service alerts as MS Teams messages</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">slack</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                        </span><span style="color:#8f5902;font-style:italic"># Send service alerts as Slack messages</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">webhook</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># Send service alerts as outbound webhooks/http calls</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Secondly, the configuration for the various destinations <em>may</em> also contain settings specific to service monitoring.<br>
Not all destinations support this, but for example the Teams destination does:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">Butler</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Settings for notifications and messages sent to MS Teams</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">teamsNotification</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">serviceStopped</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">webhookURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;web hook URL from MS Teams&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">messageType</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">formatted         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># formatted / basic. Formatted means that template file below will be used to create the message.</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">basicMsgTemplate: &#39;Windows service stopped</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;{{serviceName}}&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">on</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">host &#34;{{host}}&#34;&#39;      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Only needed if message type = basic</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">rateLimit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">30</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># Min seconds between messages for a given Windows service. Defaults to 5 minutes.</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">templateFile</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/path/to/teams/template/directory/service-stopped.handlebars</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">serviceStarted</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">webhookURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;web hook URL from MS Teams&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">messageType</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">formatted         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># formatted / basic. Formatted means that template file below will be used to create the message.</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">basicMsgTemplate: &#39;Windows service started</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;{{serviceName}}&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">on</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">host &#34;{{host}}&#34;&#39;      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Only needed if message type = basic</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">rateLimit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">30</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># Min seconds between messages for a given Windows service. Defaults to 5 minutes.</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">templateFile</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/path/to/teams/template/directory/service-started.handlebars</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Similarly, service state changes can be sent to outbound webhooks:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">Butler</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Settings for notifications and messages sent using outgoing webhooks</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">webhookNotification</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">serviceMonitor</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">rateLimit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">15</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># Min seconds between outgoing webhook calls, per Windows service that is monitored. Defaults to 5 minutes.</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">webhooks</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#204a87;font-weight:bold">description</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;This outgoing webhook is used to...&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">webhookURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://host.my.domain:port/some/path   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># outgoing webhook that Butler will call</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">httpMethod</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">POST                                   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># GET/POST/PUT. Note that the body and URL query parameters differs depending on which method is used</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#204a87;font-weight:bold">description</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;This outgoing webhook is used to...&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">webhookURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://host.my.domain:port/some/path   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># outgoing webhook that Butler will call</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">httpMethod</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">PUT                                    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># GET/POST/PUT. Note that the body and URL query parameters differs depending on which method is used</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#204a87;font-weight:bold">description</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;This outgoing webhook is used to...&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">webhookURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://host.my.domain:port/some/path   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># outgoing webhook that Butler will call</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">httpMethod</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">GET                                    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># GET/POST/PUT. Note that the body and URL query parameters differs depending on which method is used</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>To get MQTT messages when a service stops or starts, configure the MQTT section of the config file:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">Butler</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">mqttConfig</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                                     </span><span style="color:#8f5902;font-style:italic"># Should Qlik Sense events be forwarded as MQTT messages?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">brokerHost</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;FQDN or IP of MQTT server&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">brokerPort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1883</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">azureEventGrid</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># If set to true, Butler will connect to an Azure Event Grid MQTT Broker, using brokerHost and brokerPort above </span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">clientId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;client ID&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">clientCertFile</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;path to client certificate file&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">clientKeyFile</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;path to client key file&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">serviceRunningTopic</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">qliksense/service_running</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">serviceStoppedTopic</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">qliksense/service_stopped</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">serviceStatusTopic</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">qliksense/service_status</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div>
</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-30913de421ba8a1881920f31d3308f5e">12 - Real-time metrics</h1>
    <div class="lead">Details about the real-time metrics (active user count etc) provided by Butler.</div>
	

<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Deprecated feature</h4>

    <p>Looking for info on number of active Sense users, what apps are loaded into the Sense engine or what warnings and errors are logged by Sense?</p>
<p>If yes, you are probably looking for <a href="https://butler-sos.ptarmiganlabs.com">Butler SOS</a>, another open source project in the <a href="https://github.com/ptarmiganlabs">Butler family of tools</a>.</p>
<p>The metrics offered by Butler (this tool) are rather basic and has some inherit design issue that have been adressed in Butler SOS.</p>
<p>That said, there certainly are cases where Butler&rsquo;s metrics will work fine.<br>
Take a look at both tools and then decide which suits your needs best. The most common scenario is actually to use both tools: Butler for it&rsquo;s REST API and MQTT integration, and Butler SOS for enterprise grade operational monitoring of Qlik Sense Enterprise.</p>


</div>


</div>



    
      
  
  
  
  

  
  

  

    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="SenseOps mailing list" aria-label="SenseOps mailing list">
    <a class="text-white" target="_blank" rel="noopener" href="https://ptarmiganlabs.com/#/portal/signup" aria-label="SenseOps mailing list">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Discussion forums on GitHub" aria-label="Discussion forums on GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/ptarmiganlabs/butler/discussions" aria-label="Discussion forums on GitHub">
      <i class="fa fa-comments"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Ptarmigan Labs" aria-label="Ptarmigan Labs">
    <a class="text-white" target="_blank" rel="noopener" href="https://ptarmiganlabs.com" aria-label="Ptarmigan Labs">
      <i class="fa fa-external-link"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="LinkedIn" aria-label="LinkedIn">
    <a class="text-white" target="_blank" rel="noopener" href="https://www.linkedin.com/in/gorsan/" aria-label="LinkedIn">
      <i class="fab fa-linkedin"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/ptarmiganlabs/butler" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Bug reports &amp; Feature requests" aria-label="Bug reports &amp; Feature requests">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/ptarmiganlabs/butler/issues/new/choose" aria-label="Bug reports &amp; Feature requests">
      <i class="fa fa-bug"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Get in touch with Ptarmigan Labs" aria-label="Get in touch with Ptarmigan Labs">
    <a class="text-white" target="_blank" rel="noopener" href="mailto://info@ptarmiganlabs.com" aria-label="Get in touch with Ptarmigan Labs">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2024 Ptarmigan Labs AB All Rights Reserved</small>
        
	
		<p class="mt-2"><a href="/docs/about/">About</a></p>
	
      </div>
    </div>
  </div>
</footer>


    </div>
    
  <script src="/js/main.min.523509bf13607632997fb2eeed668872c5fb9c71c1c18f4d68e77a786fa8136f.js" integrity="sha256-UjUJvxNgdjKZf7Lu7WaIcsX7nHHBwY9NaOd6eG&#43;oE28=" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>
